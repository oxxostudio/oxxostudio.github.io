$(function(){function t(){if(n.width()>1e3){o=n.width(),contantWidth=l.width();var t=o/2+contantWidth/2+70,e=o/2+contantWidth/2+75,i=o/2-contantWidth/2-105;$(".social-icon").css({left:t+"px"}),$(".arrow-left").css({left:i+"px"}).attr("target","_top"),$(".arrow-right").css({left:e+"px"}).attr("target","_top"),n.scroll(function(){n.scrollTop()>150?$(".social-icon, .arrow-left, .arrow-right").not("animated").fadeIn(300):$(".social-icon, .arrow-left, .arrow-right").not("animated").fadeOut(300)})}else $(".social-icon, .arrow-left, .arrow-right").hide()}function e(t){ga("send","event",t,t)}$(".article-date").attr("tag");var i,o,a,r,n=$(window),l=($(document),$("article")),c=location.href,h="/articles/"+(a=c.split("/"))[a.length-2]+"/"+a[a.length-1];r=a.pop(),$(".preview-img").unwrap("p"),function(t,e){$.getJSON("/json/pageList.json",function(t){t.forEach(function(t){t.site==h&&($(".tag").addClass(t.tag),$("h1").attr("data-date",t.date),tagName=t.tag)}),dataLength=t.length;var o,a,r=[],n=0;for(o=0;o<dataLength;o++)t[o].tag==tagName&&(r[n]=t[o],n+=1),-1!=t[o].site.indexOf(e)&&(a=o);var l,c=[];if(n<=5)for(console.log(n),i=0;i<n;i++)l=r[i].img?r[i].img:"/img"+r[i].site.replace(".html","-s.jpg"),$("#other-articles").append('<a href="'+r[i].site+'"><div><img src="'+l+'"><h4>'+r[i].title+"</h4></div></a>");else for(i=n;i>=n-4;i--){var s=Math.floor(i*Math.random(i));c[i-5]=r.splice(s,1)[0],l=c[i-5].img?c[i-5].img:"/img"+c[i-5].site.replace(".html","-s.jpg"),$("#other-articles").append('<a href="'+c[i-5].site+'"><div><img src="'+l+'"><h4>'+c[i-5].title+"</h4></div></a>")}0==a?($(".next-article h4").html("沒有下一篇文章了呦~"),$(".previous-article h4").html("<a href="+t[a+1].site+">"+t[a+1].title+"</a>"),$(".arrow-right").css({top:"-100px"}),$(".arrow-left").attr("href",t[a+1].site).attr("title",t[a+1].title)):a==dataLength-1?($(".previous-article h4").html("沒有前一篇文章了呦~"),$(".next-article h4").html("<a href="+t[a-1].site+">"+t[a-1].title+"</a>"),$(".arrow-left").css({top:"-100px"}),$(".arrow-right").attr("href",t[a-1].site).attr("title",t[a-1].title)):($(".previous-article h4").html("<a href="+t[a+1].site+">"+t[a+1].title+"</a>"),$(".arrow-left").attr("href",t[a+1].site).attr("title",t[a+1].title),$(".next-article h4").html("<a href="+t[a-1].site+">"+t[a-1].title+"</a>"),$(".arrow-right").attr("href",t[a-1].site).attr("title",t[a-1].title))})}(0,r),t(),function(t){$(".icon-home").on("click",function(){window.open("/index.html","_self")}),$(".icon-list").on("click",function(){window.open("/list.html","_self")}),$(".icon-facebook").on("click",function(){window.open("http://www.facebook.com/share.php?u="+t,"_blank"),e("share_to_facebook")}),$(".icon-google").on("click",function(){window.open("https://plus.google.com/share?url="+t,"_blank"),e("share_to_google")}),$(".icon-twitter").on("click",function(){window.open("http://twitter.com/home/?status="+t,"_blank"),e("share_to_twitter")}),$(".goto-top").on("click",function(){$("html,body").animate({scrollTop:"0"},750),e("goto_top")}),$(".previous-next").on("click",function(){e("previous-next")}),$(".content a").on("click",function(){e("link-to:"+$(this).attr("href"))}),$(".arrow-left, .arrow-right").on("click",function(){e("arrow-previous-next")})}(c),n.resize(t)});
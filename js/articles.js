$(function(){function t(){if(r.width()>1e3){a=r.width(),contantWidth=c.width();var t=a/2+contantWidth/2+70,e=a/2+contantWidth/2+75,i=a/2-contantWidth/2-105;$(".social-icon").css({left:t+"px"}),$(".arrow-left").css({left:i+"px"}).attr("target","_top"),$(".arrow-right").css({left:e+"px"}).attr("target","_top"),r.scroll(function(){r.scrollTop()>150?$(".social-icon, .arrow-left, .arrow-right").not("animated").fadeIn(300):$(".social-icon, .arrow-left, .arrow-right").not("animated").fadeOut(300)})}else $(".social-icon, .arrow-left, .arrow-right").hide()}function e(){s.each(function(){var t=$(this);if(t.attr("data-src")){var e=$(this).attr("data-src");t.offset().top-r.height()<0?(t.attr("src",e),t.removeAttr("data-src")):r.scrollTop()>0&&(t.attr("src",e),t.removeAttr("data-src"))}})}var i,a,o,n,r=$(window),c=($(document),$("article")),l=location.href,s=$(".lazy"),h="/articles/"+(o=l.split("/"))[o.length-2]+"/";o.forEach(function(t){if(-1!=t.indexOf(".html"))if(-1!=t.indexOf("?")){var e=t.split("?");n=h+e[0]}else n=h+t}),-1==l.indexOf(".html")&&(window.location.href=l+".html"),$(".preview-img").unwrap("p"),function(t){$.getJSON("/json/pageList.json",function(e){e.forEach(function(e){e.site==t&&($(".tag").addClass(e.tag),$("h1").attr("data-date",e.date),tagName=e.tag)});var a,o=[],r=0;e.forEach(function(t){t.tag==tagName&&(o[r]=t,r+=1),-1!=t.site.indexOf(n)&&(a=e.indexOf(t))});var c,l=[];if(r<=5)for(i=0;i<r;i++)c=o[i].img?o[i].img:"/img"+o[i].site.replace(".html","-s.jpg"),$("#other-articles").append('<a href="'+o[i].site+'"><div><img class="lazy" data-src="'+c+'"><h4>'+o[i].title+"</h4></div></a>"),s=$(".lazy");else for(i=r;i>=r-4;i--){var h=Math.floor(i*Math.random(i));l[i-5]=o.splice(h,1)[0],c=l[i-5].img?l[i-5].img:"/img"+l[i-5].site.replace(".html","-s.jpg"),$("#other-articles").append('<a href="'+l[i-5].site+'"><div><img class="lazy" data-src="'+c+'"><h4>'+l[i-5].title+"</h4></div></a>"),s=$(".lazy")}0==a?($(".next-article h4").html("沒有下一篇文章了呦~"),$(".previous-article h4").html("<a href="+e[a+1].site+">"+e[a+1].title+"</a>"),$(".arrow-right").css({top:"-100px"}),$(".arrow-left").attr("href",e[a+1].site).attr("title",e[a+1].title)):a==e.length-1?($(".previous-article h4").html("沒有前一篇文章了呦~"),$(".next-article h4").html("<a href="+e[a-1].site+">"+e[a-1].title+"</a>"),$(".arrow-left").css({top:"-100px"}),$(".arrow-right").attr("href",e[a-1].site).attr("title",e[a-1].title)):($(".previous-article h4").html("<a href="+e[a+1].site+">"+e[a+1].title+"</a>"),$(".arrow-left").attr("href",e[a+1].site).attr("title",e[a+1].title),$(".next-article h4").html("<a href="+e[a-1].site+">"+e[a-1].title+"</a>"),$(".arrow-right").attr("href",e[a-1].site).attr("title",e[a-1].title))}),e(),r.scroll(e)}(n),t(),function(t){$(".icon-home").on("click",function(){window.open("/index.html","_self"),ga("send","event","iconMenu","click","home")}),$(".icon-list").on("click",function(){window.open("/list.html","_self"),ga("send","event","iconMenu","click","list")}),$(".icon-facebook").on("click",function(){window.open("http://www.facebook.com/share.php?u="+t,"_blank"),ga("send","event","iconMenu","click","facebook")}),$(".icon-google").on("click",function(){window.open("https://plus.google.com/share?url="+t,"_blank"),ga("send","event","iconMenu","click","google")}),$(".icon-twitter").on("click",function(){window.open("http://twitter.com/home/?status="+t,"_blank"),ga("send","event","iconMenu","click","twitter")}),$(".goto-top").on("click",function(){$("html,body").animate({scrollTop:"0"},750),ga("send","event","iconMenu","click","top")}),$(".previous-next").on("click",function(){ga("send","event","moreLink","click","preAndNext")}),$(".content a").on("click",function(){ga("send","event","contentLink","click",$(this).attr("href"))}),$(".arrow-left, .arrow-right").on("click",function(){ga("send","event","moreLink","click","arrowLeftRight")})}(l),r.resize(t)});